!function(){"use strict";let t=null;class e{constructor(){this.enabled=this.loadPreference(),this.toggleButton=null,this.exitButton=null,this.wakeLockIndicator=null,this.init()}init(){const t=new URLSearchParams(window.location.search).get("kitchen_mode");(this.enabled||"true"===t)&&(this.applyKitchenMode(),"true"!==t||this.enabled||(this.enabled=!0,this.savePreference(!0),this.requestWakeLock())),this.createToggleButton(),this.createExitButton(),this.createWakeLockIndicator(),this.isKitchenModeActive()&&this.initStepByStepNavigation()}loadPreference(){try{return"true"===localStorage.getItem("kitchen_mode_enabled")}catch(t){return console.warn("Failed to load Kitchen Mode preference from localStorage:",t),!1}}savePreference(t){try{t?localStorage.setItem("kitchen_mode_enabled","true"):localStorage.removeItem("kitchen_mode_enabled")}catch(t){console.warn("Failed to save Kitchen Mode preference to localStorage:",t)}}isKitchenModeActive(){return document.body.classList.contains("kitchen-mode")}createToggleButton(){const t=document.querySelector('[data-testid="kitchen-mode-toggle"]');t&&(t.setAttribute("aria-checked",this.isKitchenModeActive()?"true":"false"),t.addEventListener("click",()=>this.toggle()),this.toggleButton=t)}createExitButton(){const t=document.createElement("button");t.setAttribute("data-testid","kitchen-mode-exit"),t.setAttribute("aria-label","Exit Kitchen Mode and return to normal view"),t.className="fixed top-4 right-4 z-50 bg-red-600 text-white rounded-lg shadow-lg hover:bg-red-700 transition-colors touch-target flex items-center gap-2 px-6 py-4 font-bold text-xl",t.innerHTML='\n                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>\n                </svg>\n                <span>Exit Kitchen Mode</span>\n            ',t.style.display=this.isKitchenModeActive()?"flex":"none",t.addEventListener("click",()=>this.disable()),document.body.appendChild(t),this.exitButton=t}createWakeLockIndicator(){const t=document.createElement("div");t.setAttribute("data-testid","wake-lock-indicator"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-label","Screen wake lock is active"),t.className="fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-green-600 text-white rounded-full px-4 py-2 shadow-lg text-sm font-medium flex items-center gap-2",t.innerHTML='\n                <svg class="w-4 h-4 animate-pulse" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">\n                    <circle cx="12" cy="12" r="10"></circle>\n                </svg>\n                <span>Screen awake</span>\n            ',t.style.display="none",document.body.appendChild(t),this.wakeLockIndicator=t}toggle(){this.isKitchenModeActive()?this.disable():this.enable()}enable(){const t=window.scrollY;this.applyKitchenMode(),this.savePreference(!0),this.requestWakeLock(),this.toggleButton&&this.toggleButton.setAttribute("aria-checked","true"),this.exitButton&&(this.exitButton.style.display="flex"),this.initStepByStepNavigation(),window.scrollTo(0,t)}disable(){const t=window.scrollY;document.body.classList.remove("kitchen-mode"),this.savePreference(!1),this.releaseWakeLock(),this.toggleButton&&this.toggleButton.setAttribute("aria-checked","false"),this.exitButton&&(this.exitButton.style.display="none"),this.destroyStepByStepNavigation(),window.scrollTo(0,t)}applyKitchenMode(){document.body.classList.add("kitchen-mode")}async requestWakeLock(){if("wakeLock"in navigator){try{t=await navigator.wakeLock.request("screen"),console.log("Wake Lock acquired"),this.wakeLockIndicator&&(this.wakeLockIndicator.style.display="flex"),t.addEventListener("release",()=>{console.log("Wake Lock released"),this.wakeLockIndicator&&(this.wakeLockIndicator.style.display="none")})}catch(t){console.error("Failed to acquire Wake Lock:",t)}this.handleVisibilityChange=async()=>{if(null!==t&&"visible"===document.visibilityState)try{t=await navigator.wakeLock.request("screen"),console.log("Wake Lock re-acquired after visibility change"),this.wakeLockIndicator&&(this.wakeLockIndicator.style.display="flex")}catch(t){console.error("Failed to re-acquire Wake Lock:",t)}},document.addEventListener("visibilitychange",this.handleVisibilityChange)}else console.log("Wake Lock API not supported")}releaseWakeLock(){t&&t.release().then(()=>{t=null,this.wakeLockIndicator&&(this.wakeLockIndicator.style.display="none")}).catch(t=>console.error("Failed to release Wake Lock:",t)),this.handleVisibilityChange&&(document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.handleVisibilityChange=null)}initStepByStepNavigation(){const t=document.querySelectorAll("ol li");0!==t.length&&(this.currentStep=0,this.instructions=t,t.forEach((t,e)=>{t.style.display=0===e?"flex":"none"}),this.createStepNavigationControls(),this.stepKeydownHandler=t=>this.handleStepKeydown(t),document.addEventListener("keydown",this.stepKeydownHandler),this.updateStep())}destroyStepByStepNavigation(){this.instructions&&(this.instructions.forEach(t=>{t.style.display="flex"}),this.navContainer&&(this.navContainer.remove(),this.navContainer=null),this.stepKeydownHandler&&(document.removeEventListener("keydown",this.stepKeydownHandler),this.stepKeydownHandler=null),this.instructions=null,this.currentStep=0)}createStepNavigationControls(){const t=document.createElement("div");t.className="flex gap-4 mt-8 justify-center items-center flex-wrap";const e=document.createElement("button");e.setAttribute("data-testid","step-previous"),e.setAttribute("aria-label","Previous step"),e.className="px-8 py-4 bg-blue-600 text-white rounded-lg text-xl font-bold touch-target hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",e.textContent="← Previous",e.addEventListener("click",()=>this.previousStep());const i=document.createElement("div");i.setAttribute("data-testid","step-indicator"),i.setAttribute("aria-live","polite"),i.className="px-6 py-4 bg-gray-200 rounded-lg text-xl font-bold text-gray-900";const n=document.createElement("button");n.setAttribute("data-testid","step-next"),n.setAttribute("aria-label","Next step"),n.className="px-8 py-4 bg-blue-600 text-white rounded-lg text-xl font-bold touch-target hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",n.textContent="Next →",n.addEventListener("click",()=>this.nextStep()),t.appendChild(e),t.appendChild(i),t.appendChild(n);const o=document.querySelector("ol");o&&o.parentNode.insertBefore(t,o.nextSibling),this.navContainer=t,this.prevButton=e,this.stepIndicator=i,this.nextButton=n}previousStep(){this.currentStep>0&&(this.currentStep--,this.updateStep())}nextStep(){this.currentStep<this.instructions.length-1&&(this.currentStep++,this.updateStep())}updateStep(){this.instructions&&(this.instructions.forEach(t=>t.style.display="none"),this.instructions[this.currentStep].style.display="flex",this.stepIndicator&&(this.stepIndicator.textContent=`Step ${this.currentStep+1} of ${this.instructions.length}`),this.prevButton&&(this.prevButton.disabled=0===this.currentStep),this.nextButton&&(this.nextButton.disabled=this.currentStep===this.instructions.length-1,this.nextButton.textContent=this.currentStep===this.instructions.length-1?"✓ Done":"Next →"))}handleStepKeydown(t){("ArrowLeft"===t.key||"ArrowUp"===t.key)&&this.currentStep>0?(this.previousStep(),t.preventDefault()):("ArrowRight"===t.key||"ArrowDown"===t.key||" "===t.key)&&this.currentStep<this.instructions.length-1&&(this.nextStep(),t.preventDefault())}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new e}):new e}();