(function(){"use strict";if(!("serviceWorker"in navigator)){console.warn("Service Worker not supported in this browser");return}document.addEventListener("DOMContentLoaded",function(){registerServiceWorker()});async function registerServiceWorker(){try{const registration=await navigator.serviceWorker.register("/sw.js?v=v0.1",{scope:"/"});console.log("Service Worker registered successfully:",registration);console.log("Service Worker scope:",registration.scope);if(!navigator.serviceWorker.controller){navigator.serviceWorker.addEventListener("controllerchange",()=>{console.log("Service Worker now controlling page, reloading...");window.location.reload()})}registration.addEventListener("updatefound",()=>{const newWorker=registration.installing;console.log("Service Worker update found");newWorker.addEventListener("statechange",()=>{console.log("Service Worker state changed:",newWorker.state);if(newWorker.state==="installed"&&navigator.serviceWorker.controller){showUpdateNotification()}})});setInterval(()=>{registration.update()},3e5)}catch(error){console.error("Service Worker registration failed:",error)}}function showUpdateNotification(){console.log("New version available. Refresh to update.");const banner=document.createElement("div");banner.className="fixed top-0 left-0 right-0 bg-primary-500 text-white p-4 flex items-center justify-between z-50 shadow-lg";banner.innerHTML=`
            <span class="font-medium">New version available. Refresh to update.</span>
            <button id="sw-refresh-btn" class="bg-white text-primary-500 px-4 py-2 rounded font-medium hover:bg-gray-100 transition-colors">
                Refresh
            </button>
        `;document.body.insertBefore(banner,document.body.firstChild);document.getElementById("sw-refresh-btn").addEventListener("click",()=>{window.location.reload()})}})();