<!DOCTYPE html>
<html {% if let Ok(lang)="preferred_language_iso" |value::<String> %}lang="{{ lang }}"{% endif %}>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="{% block meta_description %}Intelligent meal planning and cooking optimization{% endblock %}">

    <title>{% block title %}imkitchen{% endblock %}</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href={{ "/static/icons/icon-192.png?v=" ~ env!("CARGO_PKG_VERSION") }}>

    <!-- PWA Manifest -->
    <link rel="manifest" href={{ "/static/manifest.json?v=" ~ env!("CARGO_PKG_VERSION") }}>
    <meta name="theme-color" content="#2563eb">

    <!-- iOS PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="imkitchen">
    <link rel="apple-touch-icon" href={{ "/static/icons/apple-touch-icon.png?v=" ~ env!("CARGO_PKG_VERSION") }}>

    <!-- Main CSS - loaded synchronously to prevent visual breaking -->
    <link rel="stylesheet" href={{ "/static/css/main.css?v=" ~ env!("CARGO_PKG_VERSION") }}>

    <!-- Core scripts (loaded on all pages) -->
    <script src={{ "/static/js/twinspark.min.js?v=" ~ env!("CARGO_PKG_VERSION") }} defer></script>

    <!-- PWA scripts (loaded on all pages for PWA functionality) -->
    <script src={{ "/static/js/pwa-install.min.js?v=" ~ env!("CARGO_PKG_VERSION") }} defer></script>
    <script src={{ "/static/js/sw-register.min.js?v=" ~ env!("CARGO_PKG_VERSION") }} defer></script>

    <!-- Page-specific scripts (override in child templates) -->
    {% block page_scripts %}{% endblock %}

    {% block extra_head %}{% endblock %}

<style>
  #mobile-menu-button {
    appearance: none;
    opacity: 0;
    width: 0;
    height: 0;
    position: fixed;
  }

  :where(#mobile-menu-button:checked ~ #mobile-menu) {
    display: block;
  }
</style>
</head>
{% block body %}{% endblock body %}
</html>
