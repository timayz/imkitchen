<story-context id="bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>9</epicId>
    <storyId>9.7</storyId>
    <title>Responsive Design and Accessibility Testing</title>
    <status>Approved</status>
    <generatedAt>2025-10-26</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>/home/snapiz/projects/github/timayz/imkitchen/docs/stories/story-9.7.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>frontend developer</asA>
    <iWant>ensure all new UI is responsive and accessible</iWant>
    <soThat>users on mobile and assistive technology can use features</soThat>
    <tasks>
      - Create responsive testing checklist and log
      - Test responsive breakpoints (mobile 375px, tablet 768px, desktop 1920px)
      - Verify touch target sizes on mobile (≥44x44px)
      - Test keyboard navigation
      - Screen reader testing (NVDA/VoiceOver)
      - Color contrast testing (WCAG AA 4.5:1)
      - Focus indicator testing
      - Lighthouse accessibility audit (score >90)
      - Automated accessibility testing in CI
      - Cross-browser testing
      - Create comprehensive test report
    </tasks>
  </story>

  <acceptanceCriteria>
    <criterion id="9.7.1">All pages tested on mobile (375px), tablet (768px), desktop (1920px) - manual testing log</criterion>
    <criterion id="9.7.2">Calendar: Tabs on desktop, carousel on mobile (responsive breakpoint @md:)</criterion>
    <criterion id="9.7.3">Forms: Full-width inputs on mobile (w-full), constrained on desktop (max-w-md)</criterion>
    <criterion id="9.7.4">Modals: Centered on desktop with backdrop, full-height on mobile</criterion>
    <criterion id="9.7.5">Touch targets ≥44x44px on mobile (buttons, checkboxes, links) - WCAG AA compliance</criterion>
    <criterion id="9.7.6">Keyboard navigation works for all interactive elements (Tab order logical, Enter/Space activate)</criterion>
    <criterion id="9.7.7">Screen reader testing: All content accessible with NVDA/VoiceOver (ARIA labels, semantic HTML)</criterion>
    <criterion id="9.7.8">Color contrast ratios meet WCAG AA: 4.5:1 for normal text, 3:1 for large text (verified with WAVE tool)</criterion>
    <criterion id="9.7.9">Focus indicators visible for all interactive elements (2px border, 4px offset, primary-500 color)</criterion>
    <criterion id="9.7.10">Lighthouse accessibility score >90 for all pages (automated test in CI)</criterion>
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/tech-spec-epic-9.md</path>
        <title>Story 9.7: Responsive Design and Accessibility Testing</title>
        <section>AC-9.7.1 through AC-9.7.10</section>
        <snippet>Comprehensive responsive and accessibility testing for all Epic 9 pages. Test breakpoints (375px, 768px, 1920px), touch targets ≥44x44px, keyboard navigation, screen readers (NVDA/VoiceOver), contrast ratios (4.5:1), focus indicators, Lighthouse score >90. Manual testing log + automated CI tests.</snippet>
      </doc>
      <doc>
        <path>docs/tech-spec-epic-9.md</path>
        <title>Non-Functional Requirements</title>
        <section>WCAG AA Compliance</section>
        <snippet>WCAG AA requirements: Contrast ratios (4.5:1 normal, 3:1 large), touch targets (44x44px), keyboard navigation, visible focus indicators, screen reader support (semantic HTML, ARIA labels). Lighthouse accessibility score >90 target.</snippet>
      </doc>
    </docs>
    <code>
      <artifact>
        <path>All Epic 9 templates</path>
        <kind>template</kind>
        <symbol>epic-9-templates</symbol>
        <lines>N/A</lines>
        <reason>All templates from Stories 9.1-9.6 to be tested for accessibility and responsive design compliance.</reason>
      </artifact>
    </code>
    <dependencies>
      <frontend>
        <tool name="Lighthouse">Automated accessibility audits (score >90 required)</tool>
        <tool name="WAVE">Browser extension for contrast and ARIA checking</tool>
        <tool name="axe DevTools">Browser extension for detailed accessibility issues</tool>
        <tool name="NVDA">Windows screen reader for accessibility testing</tool>
        <tool name="VoiceOver">Mac/iOS screen reader for accessibility testing</tool>
        <tool name="Lighthouse CI">Run Lighthouse in CI pipeline, fail build if score <90</tool>
      </frontend>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint>WCAG AA Compliance: Industry standard for web accessibility. Required by law in many jurisdictions.</constraint>
    <constraint>Mobile-First Design: Start with mobile layouts, enhance for larger screens with Tailwind breakpoints.</constraint>
    <constraint>Manual Testing Required: Automated tools catch ~40% of accessibility issues. Manual screen reader testing essential.</constraint>
    <constraint>Lighthouse Score >90: High bar ensuring accessibility quality. Enforced in CI pipeline.</constraint>
  </constraints>

  <interfaces>
    <interface>
      <name>Lighthouse CI Configuration</name>
      <kind>config</kind>
      <signature>lighthouserc.json with assertions for accessibility score >90</signature>
      <path>Project root</path>
      <description>Lighthouse CI configuration file. Defines URLs to test, assertions (accessibility >90), and upload settings. Runs in CI pipeline.</description>
    </interface>
  </interfaces>

  <tests>
    <standards>
      Manual testing with real devices and screen readers. Automated Lighthouse tests in CI. WAVE tool for contrast verification. Browser DevTools for touch target measurement. Playwright for keyboard navigation testing. Comprehensive test report documenting all results, issues, and resolutions.
    </standards>
    <locations>
      - docs/testing/epic-9-responsive-test-log.md (manual testing documentation)
      - docs/testing/epic-9-accessibility-report.md (comprehensive accessibility audit report)
      - .github/workflows/accessibility.yml (CI workflow for Lighthouse tests)
      - lighthouserc.json (Lighthouse CI configuration)
    </locations>
    <ideas>
      <test ac="9.7.1">Manual test: All pages (calendar, preferences, recipe form, shopping list) at 375px, 768px, 1920px</test>
      <test ac="9.7.2">Responsive test: Calendar shows carousel <768px, tabs ≥768px (verify @md: breakpoint)</test>
      <test ac="9.7.3">Responsive test: Form inputs w-full on mobile, max-w-md on desktop</test>
      <test ac="9.7.4">Responsive test: Modals centered on desktop, full-height on mobile</test>
      <test ac="9.7.5">Touch target test: Measure all buttons, checkboxes, links with ruler tool → Verify ≥44x44px</test>
      <test ac="9.7.6">Keyboard test: Tab through all interactive elements, verify logical order, Enter/Space activate</test>
      <test ac="9.7.7">Screen reader test: NVDA/VoiceOver reads all content, ARIA labels announced, semantic HTML</test>
      <test ac="9.7.8">Contrast test: WAVE tool verifies all text meets 4.5:1 (normal) or 3:1 (large) contrast</test>
      <test ac="9.7.9">Focus indicator test: Tab to all interactive elements, verify visible focus indicators (2px border, 4px offset)</test>
      <test ac="9.7.10">Lighthouse CI test: Run on /plan, /profile/meal-planning-preferences, /recipes/new, /shopping → Verify score >90</test>
    </ideas>
  </tests>
</story-context>
